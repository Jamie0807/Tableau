# Tableau 进阶学习指南

## 📚 学习路径概览

本指南将带您从基础到进阶，掌握 Tableau 的高级功能。建议按照以下顺序学习。

---

## 🎯 第一阶段：扩展当前项目（预计3-5天）

### 任务清单

#### ✅ 任务1：添加客户类型分析图表
**学习目标**：理解分类数据对比

**操作步骤**：
1. 新建工作表 `Sheet 4`
2. 创建客户类型销售对比（堆叠条形图）
   - 拖动"客户类型"到行
   - 拖动"销售额"到列
   - 拖动"产品类别"到颜色（显示类别分布）
   - 添加数据标签
3. 创建客户类型数量统计（饼图）
   - 使用 `COUNTD(客户ID)` 统计客户数量
   - 显示百分比

**预期效果**：了解不同客户类型的购买特征和占比

---

#### ✅ 任务2：创建 Top 10 产品排行榜
**学习目标**：数据筛选和排名

**操作步骤**：
1. 新建工作表 `Sheet 5`
2. 创建产品销售排行榜
   - 拖动"产品名称"到行
   - 拖动"销售额"到列
   - 右键产品名称 → 筛选器 → Top → 按字段 → 前10
   - 降序排序
   - 添加条件格式（颜色渐变）
3. 添加排名编号
   - 创建计算字段：`RANK(SUM([销售额]))`
   - 将排名添加到行的最前面

**预期效果**：清晰展示最畅销的产品

---

#### ✅ 任务3：添加更多筛选器
**学习目标**：增强仪表盘交互性

**操作步骤**：
1. **添加时间筛选器**
   - 在仪表盘中，右键任一图表 → 筛选器 → 订单日期
   - 选择筛选器类型：相对日期或滑块
   - 应用到所有工作表

2. **添加产品类别筛选器**
   - 拖动"产品类别"到筛选器区域
   - 选择"多值（下拉菜单）"或"单值（列表）"
   - 应用到所有工作表

3. **添加地区筛选器**
   - 拖动"地区"到筛选器区域
   - 允许多选
   - 应用到所有工作表

4. **优化筛选器布局**
   - 将筛选器拖动到仪表盘顶部或右侧
   - 调整大小和对齐方式
   - 可以使用"仅在悬停时显示标题"减少空间占用

**预期效果**：用户可以按时间、类别、地区灵活筛选数据

---

#### ✅ 任务4：创建高级计算指标
**学习目标**：掌握计算字段

**1. 创建利润率字段**
```
// 利润率百分比
SUM([利润]) / SUM([销售额])
```
- 格式化为百分比
- 创建利润率趋势图（折线图）
- 添加参考线（平均利润率）

**2. 创建平均订单价值（AOV）**
```
// Average Order Value
SUM([销售额]) / COUNTD([订单ID])
```

**3. 创建销售额分级**
```
// 销售额等级
IF SUM([销售额]) >= 10000 THEN "高"
ELSEIF SUM([销售额]) >= 5000 THEN "中"
ELSE "低"
END
```
- 用于条件格式化

**4. 创建月度环比增长率（如果有多月数据）**
```
// 环比增长率
(SUM([销售额]) - LOOKUP(SUM([销售额]), -1)) 
/ LOOKUP(SUM([销售额]), -1)
```
- 需要在表计算中设置"计算依据"为订单日期

**应用场景**：
- 创建 KPI 仪表盘
- 利润率 vs 销售额散点图
- 按利润率给产品分类排序

---

## 🎨 第二阶段：新的可视化类型（预计2-3天）

### 任务清单

#### ✅ 任务5：创建热力图（Heatmap）
**学习目标**：多维数据对比

**使用场景**：地区 × 产品类别销售热力图

**操作步骤**：
1. 新建工作表 `Sheet 6`
2. 拖动"地区"到列
3. 拖动"产品类别"到行
4. 拖动"销售额"到颜色
5. 拖动"销售额"到标签
6. 调整颜色：
   - 点击颜色 → 编辑颜色
   - 选择"温度偏差"或"橙色-蓝色"渐变
   - 设置"已分级"或"连续"
7. 调整单元格大小：格式 → 单元格 → 大小

**预期效果**：快速识别高/低销售的组合

---

#### ✅ 任务6：创建树状图（Treemap）
**学习目标**：层次结构可视化

**使用场景**：产品类别和具体产品的销售占比

**操作步骤**：
1. 新建工作表 `Sheet 7`
2. 选择标记类型为"方形"
3. 拖动"产品类别"到颜色
4. 拖动"产品名称"到标签
5. 拖动"销售额"到大小
6. 拖动"销售额"到标签（显示具体数值）
7. 优化：
   - 调整颜色为不同色系
   - 标签格式：产品名称 + 销售额 + 占比

**预期效果**：一眼看出各产品的相对占比和层次关系

---

#### ✅ 任务7：创建散点图（Scatter Plot）
**学习目标**：相关性分析

**使用场景**：销售额 vs 利润分析

**操作步骤**：
1. 新建工作表 `Sheet 8`
2. 标记类型选择"圆圈"
3. 拖动"销售额"到列
4. 拖动"利润"到行
5. 拖动"产品类别"到颜色（区分类别）
6. 拖动"产品名称"到标签或详细信息
7. 可选：拖动"数量"到大小（气泡图）
8. 添加趋势线：
   - 分析 → 趋势线 → 显示趋势线
   - 可以分别为每个类别添加趋势线

**分析方向**：
- 高销售额但低利润的产品（需要优化）
- 高利润率的明星产品
- 离群值（异常数据点）

---

#### ✅ 任务8：创建地图可视化
**学习目标**：地理数据展示

**使用场景**：中国各省份销售分布

**操作步骤**：

**方法1：符号地图（Symbol Map）**
1. 新建工作表 `Sheet 9`
2. 双击"省份"字段（Tableau自动识别为地理角色）
3. 拖动"销售额"到大小
4. 拖动"销售额"到颜色
5. 拖动"省份"和"销售额"到标签
6. 调整：
   - 地图 → 背景图层 → 选择样式
   - 地图 → 地图图层 → 调整透明度

**方法2：填充地图（Filled Map）**
1. 标记类型改为"地图"
2. 其他设置相同
3. 每个省份会被填充颜色

**如果省份无法识别**：
1. 右键"省份" → 地理角色 → 省/自治区
2. 或创建计算字段添加"中国"前缀
3. 或手动编辑位置（右键未知位置 → 编辑位置）

**预期效果**：直观展示销售地域分布

---

## 🚀 第三阶段：高级功能（预计3-5天）

### 任务清单

#### ✅ 任务9：参数（Parameters）动态控制
**学习目标**：用户自定义分析维度

**实战案例：创建动态度量选择器**

**操作步骤**：

**1. 创建参数**
- 右键空白处 → 创建参数
- 名称：`选择指标`
- 数据类型：字符串
- 允许值：列表
- 值列表：
  - `销售额`
  - `利润`
  - `数量`
  - `折扣`
- 当前值：销售额

**2. 创建计算字段**
```
// 动态指标
CASE [选择指标]
    WHEN "销售额" THEN SUM([销售额])
    WHEN "利润" THEN SUM([利润])
    WHEN "数量" THEN SUM([数量])
    WHEN "折扣" THEN AVG([折扣])
END
```

**3. 应用到图表**
- 创建新工作表
- 用"动态指标"替代原来的固定度量
- 右键参数 → 显示参数控件

**4. 高级应用：动态 Top N**
- 创建参数：`Top N 数量`（整数，范围1-20）
- 在筛选器中使用：Top [Top N 数量] by 销售额

**预期效果**：用户可以通过下拉菜单切换查看不同指标

---

#### ✅ 任务10：集合（Sets）和组（Groups）
**学习目标**：数据分段和分组

**集合（Sets）应用**

**1. 创建固定集合：Top 5 产品**
- 右键"产品名称" → 创建 → 集合
- 名称：`Top 5 产品`
- 使用全部 → 按字段 → Top 5 → 销售额 → Sum
- 点击确定

**2. 创建动态集合：高利润产品**
- 创建集合
- 条件 → 按字段 → 利润 → 总和 → >= 5000

**3. 使用集合**
- 拖动集合到颜色（区分 In/Out）
- 拖动集合到筛选器（仅显示集合内数据）
- 创建组合集合（交集、并集、差集）

**组（Groups）应用**

**1. 创建地区组**
- 右键"省份" → 创建 → 组
- 选择多个省份 → 组
- 创建：
  - `华东地区`：上海、江苏、浙江、安徽等
  - `华北地区`：北京、天津、河北等
  - `华南地区`：广东、广西、海南等

**2. 使用组**
- 用组替代原始维度进行聚合分析

---

#### ✅ 任务11：LOD 表达式
**学习目标**：控制计算的粒度级别

**常用 LOD 表达式**

**1. FIXED - 忽略筛选器影响**
```
// 总销售额（不受筛选器影响）
{ FIXED : SUM([销售额]) }

// 每个客户的总购买额
{ FIXED [客户名称] : SUM([销售额]) }
```

**2. INCLUDE - 包含额外维度**
```
// 产品级别的平均销售额（即使视图是类别级别）
{ INCLUDE [产品名称] : AVG([销售额]) }
```

**3. EXCLUDE - 排除某个维度**
```
// 排除产品维度的总销售额
{ EXCLUDE [产品名称] : SUM([销售额]) }
```

**实战案例：客户分层分析**

**创建客户价值分层**
```
// 步骤1：计算每个客户的总购买额
{ FIXED [客户名称] : SUM([销售额]) }

// 步骤2：创建客户分级计算字段
IF { FIXED [客户名称] : SUM([销售额]) } >= 50000 THEN "VIP客户"
ELSEIF { FIXED [客户名称] : SUM([销售额]) } >= 20000 THEN "重要客户"
ELSEIF { FIXED [客户名称] : SUM([销售额]) } >= 10000 THEN "普通客户"
ELSE "新客户"
END
```

**应用**：
- 创建客户分层分布饼图
- 分析不同层级客户的购买行为

---

#### ✅ 任务12：仪表盘动作（Dashboard Actions）进阶
**学习目标**：创建复杂的交互逻辑

**1. 筛选器动作（Filter Actions）- 已掌握** ✅

**2. 高亮显示动作（Highlight Actions）**

**操作步骤**：
- 仪表盘 → 操作 → 添加操作 → 突出显示
- 源工作表：地区销售图
- 目标工作表：所有相关图表
- 运行操作条件：悬停
- 目标高亮显示：选定的字段
- 效果：鼠标悬停在某个地区，其他图表中该地区的数据高亮

**3. URL 动作（URL Actions）**

**使用场景**：点击产品名称打开产品详情页

**操作步骤**：
- 仪表盘 → 操作 → 添加操作 → 转到 URL
- URL：`https://www.example.com/product?name=<产品名称>`
- （使用 `<字段名>` 插入动态值）

**4. 工作表切换动作（Go to Sheet）**

**使用场景**：点击概览图跳转到详细分析工作表

**操作步骤**：
- 仪表盘 → 操作 → 添加操作 → 转到工作表
- 源工作表：概览图
- 目标工作表：详细分析表
- 运行操作条件：选择
- 可传递筛选器到目标工作表

**5. 参数更改动作（Change Parameter）**

**使用场景**：点击图表元素自动更新参数值

**操作步骤**：
- 仪表盘 → 操作 → 添加操作 → 更改参数
- 源字段：产品类别
- 目标参数：选择的类别
- 效果：点击某个类别，参数自动更新，驱动其他图表变化

---

## 📋 完整项目进阶方案

### 新建进阶仪表盘：销售分析指挥中心

**布局规划（2页仪表盘）**

**第1页：销售概览（Overview）**
- 顶部：KPI 卡片（总销售额、总利润、利润率、订单数）
- 中上：月度趋势图（支持参数切换指标）
- 中间：地区分布地图（符号地图）
- 底部左：产品类别树状图
- 底部右：客户类型分析

**第2页：详细分析（Details）**
- 左上：Top 10 产品排行榜
- 右上：销售额 vs 利润散点图
- 中间：地区 × 类别热力图
- 底部：订单明细表（带条件格式）

**交互功能**：
- 全局筛选器：时间、地区、产品类别
- 参数控制：动态指标选择、Top N 数量
- 点击地图 → 其他图表筛选
- 悬停高亮显示
- 页面导航按钮

---

## 🎯 学习检查点

### 完成标志

- [ ] 创建至少 12 个不同的工作表
- [ ] 掌握 4 种新的图表类型（热力图、树状图、散点图、地图）
- [ ] 创建至少 5 个计算字段
- [ ] 使用至少 2 个参数
- [ ] 创建至少 1 个集合和 1 个组
- [ ] 编写至少 1 个 LOD 表达式
- [ ] 配置至少 3 种不同的仪表盘动作
- [ ] 完成 2 个进阶仪表盘页面

### 能力提升目标

**初级 → 中级**
- ✅ 独立创建多种图表类型
- ✅ 使用计算字段进行数据转换
- ✅ 设计清晰的仪表盘布局
- ✅ 配置基本的交互功能

**中级 → 高级**
- ⬜ 使用 LOD 表达式解决复杂分析需求
- ⬜ 参数化驱动动态分析
- ⬜ 集合和组的高级应用
- ⬜ 设计多页面联动仪表盘
- ⬜ 优化仪表盘性能

---

## 💡 学习建议

### 每日学习计划

**第1-2天**：任务1-4（扩展基础图表和计算字段）
**第3-4天**：任务5-8（新的可视化类型）
**第5-7天**：任务9-12（高级功能）
**第8-9天**：整合项目，创建进阶仪表盘
**第10天**：优化、发布、总结

### 学习方法

1. **边学边做**：每学一个功能立即实践
2. **记录笔记**：遇到的问题和解决方案
3. **对比优化**：新旧版本对比，看到进步
4. **分享交流**：将新版仪表盘分享到 Tableau Public
5. **查阅文档**：遇到不懂的功能查看 Tableau 官方文档

### 推荐资源

- **Tableau 官方教程**：https://www.tableau.com/learn/training
- **Tableau Public 作品集**：参考优秀作品获取灵感
- **Tableau 社区论坛**：https://community.tableau.com/
- **YouTube 教程**：搜索 "Tableau Advanced Tutorial"

---

## 🎓 认证准备（可选）

如果您想获得 Tableau 官方认证：

**Tableau Desktop Specialist**
- 难度：初级
- 内容：基础操作、图表类型、计算字段、仪表盘
- 准备时间：完成本进阶指南后即可尝试

**Tableau Certified Data Analyst**
- 难度：中级
- 内容：LOD、表计算、统计分析、高级图表
- 准备时间：完成进阶学习 + 2-3个月实战

---

## 📞 遇到问题？

记录在 `项目进度记录.md` 中，我会帮您解决！

祝学习顺利！🚀
